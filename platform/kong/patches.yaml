_format_version: "1.0"

# Any final patches the Platform team may want to apply should go here
patches:

  # Ensure all real routes are only serving https
  - selectors:
    - $.services[*].routes[?(@.name != "acme-dummy-route")]
    values:
      protocols:
      - https

  # Add defaults for plugin configurations that the teams
  # can use easily
  - selectors:
    - $._plugin_configs
    values:
      default-jwt:
        key_claim_name: "iss"
        secret_is_base64: false
        maximum_expiration: 86400

  # Tag all entities that are managed by the platform
  # team process so we can isolate entities that may be
  # created using other means on the system. For example,
  # consumer credentials may be defined elsewhere and we
  # don't want deck to sync or diff off them in this process
  - selectors:
    - $
    values:
      tags:
        - platform-repo-managed

